<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Lịch sử nạp tiền</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="container mt-4">
<h3>Lịch sử nạp tiền</h3>

<form class="row mb-3" method="get" th:action="@{/templates/topup/topups}">
    <div class="col-md-3">
        <label>Trạng thái:</label>
        <select name="status" class="form-select">
            <option value="">Tất cả</option>
            <option th:each="s : ${statusOptions}"
                    th:value="${s}"
                    th:text="${s}"
                    th:selected="${s == selectedStatus}"></option>
        </select>
    </div>

    <div class="col-md-3">
        <label>Từ ngày:</label>
        <input type="datetime-local" name="from" class="form-control"
               th:value="${from != null ? #temporals.format(from, 'yyyy-MM-dd''T''HH:mm') : ''}">
    </div>

    <div class="col-md-3">
        <label>Đến ngày:</label>
        <input type="datetime-local" name="to" class="form-control"
               th:value="${to != null ? #temporals.format(to, 'yyyy-MM-dd''T''HH:mm') : ''}">
    </div>

    <div class="col-md-3 align-self-end">
        <button type="submit" class="btn btn-primary w-100">Lọc</button>
    </div>
</form>

<table class="table table-striped">
    <thead>
    <tr>
        <th>Ngày tạo</th>
        <th>Nhà cung cấp</th>
        <th>Số tiền</th>
        <th>Trạng thái</th>
        <th>Mã giao dịch</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="t : ${topups.content}">
        <td th:text="${#temporals.format(t.createdAt, 'dd/MM/yyyy HH:mm')}"></td>
        <td th:text="${t.provider}"></td>
        <td>
            <span th:text="${#numbers.formatDecimal(t.moneyAmount, 0, 'COMMA', 0, 'POINT')}"></span> ₫
        </td>
        <td>
            <span th:classappend="${t.status == 'SUCCESS'} ? 'text-success' : (t.status == 'FAILED' ? 'text-danger' : 'text-secondary')"
                  th:text="${t.status}"></span>
        </td>
        <td th:text="${t.paymentRef}"></td>
    </tr>
    </tbody>
</table>

<nav th:if="${topups.totalPages > 1}">
    <ul class="pagination">
        <li class="page-item" th:classappend="${topups.first}? 'disabled'">
            <a class="page-link" th:href="@{|?page=${topups.number - 1}|}">Trước</a>
        </li>
        <li class="page-item" th:each="i : ${#numbers.sequence(0, topups.totalPages - 1)}"
            th:classappend="${i == topups.number}? 'active'">
            <a class="page-link" th:href="@{|?page=${i}|}" th:text="${i + 1}"></a>
        </li>
        <li class="page-item" th:classappend="${topups.last}? 'disabled'">
            <a class="page-link" th:href="@{|?page=${topups.number + 1}|}">Sau</a>
        </li>
    </ul>
</nav>
</body>
</html>
